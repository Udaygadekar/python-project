shoplist = ['Pen', 'Pencile', 'Book', 'Text Book', 'Scale', 'Marker',
            'Eraser', 'Sharpener', 'Stapler', 'Glue', 'Scissors',            'Paper', 'Folder', 'Clipboard']
Details = { 'Pen':{
        'Ball Pen':{
            'Cello':[20,7],
            'Hauser':[30,10],
            'Parker':[10,500]},
        'Gel Pen':{
            'Cello':[50,17],
            'Hauser':[90,100],
            'Parker':[100,50]},
        'Fountain Pen':{
            'Cello':[50,17],
            'Hauser':[90,100],
            'Parker':[100,50]}},
           
    'Pencile':{
        'Lead Pencile':{
            'Apsara':[20,7],
            'Doms':[30,10],
            'Nataraj':[10,5]},
        '2H Pencile':{
            'Apsara':[20,7],
            'Nataraj':[30,10],
            'Parker':[10,500]},
        'Normal Pencile':{
            'Apsara':[20,7],
            'Nataraj':[30,10],
            'Parker':[10,500]}},
    'Book':{
        'Single Line Note Book':{
            'Classmate':[60,50],
            'Prime':[60,30],
            'Yuva':[50,100],
            'Regal':[100,25]},
        'Double Line Note Book':{
            'Classmate':[60,50],
            'Prime':[60,30],
            'Yuva':[50,100],
            'Regal':[100,25]},
        'Four Line Note Book':{
            'Classmate':[60,50],
            'Prime':[60,30],
            'Yuva':[50,100],
            'Regal':[100,25]},
        'Square Box Note Book':{
            'Classmate':[60,50],
            'Prime':[60,30],
            'Yuva':[50,100],
            'Regal':[100,25]}},
    'Text Book':{
        '1st Standard':{
            'English':[100,90],
            'Hindi':[100,80],                                                                                                                                        
            'Marathi':[100,85],
            'Math':[100,95],
            'Science':[100,95],
            'Social Science':[100,95]},
        '2nd Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '3rd Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '4th Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '5th Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '6th Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '7th Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '8th Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '9th Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95]
        },
        '10th Standard': {
            'English': [100, 90],
            'Hindi': [100, 80],
            'Marathi': [100, 85],
            'Math': [100, 95],
            'Science': [100, 95],
            'Social Science': [100, 95] }},
           
    'Scale':{'Ruler':{
            'Apsara':[20,10],
            'Nataraj':[30,5],
            'Camlin':[50,30]},
        'Measuring Scale':{
            'Apsara':[10,15],
            'Nataraj':[20,8],
            'Maped':[50,25]}},
           
    'Marker':{'Permanent Marker':{
            'Camlin':[40,25],
            'Sharpie':[50,35],
            'Faber-Castell':[60,50]},
        'Whiteboard Marker':{
            'Camlin':[30,20],
            'Sharpie':[40,30],
            'Faber-Castell':[60,40]}},
           
    'Eraser':{
        'Rubber Eraser':{
            'Apsara':[5,2],
            'Nataraj':[7,3],
            'Camlin':[10,5]},
        'Ink Eraser':{
            'Pilot':[30,10],
            'Faber-Castell':[20,8],
            'Camlin':[15,6]}},
           
    'Sharpener':{'Manual Sharpener':{
            'Apsara':[10,5],
            'Nataraj':[15,8],
            'Maped':[20,10]},
        'Electric Sharpener':{
            'Faber-Castell':[200,120],
            'Maped':[150,100],
            'Apsara':[100,60]}},
           
    'Stapler':{
        'Manual Stapler':{
            'Apsara':[50,40],
            'Nataraj':[60,35],
            'Maped':[80,60]},
        'Heavy Duty Stapler':{
            'Faber-Castell':[200,120],
            'Rexel':[150,100],
            'Kangaro':[180,110]}},
           
    'Glue':{'Fevicol':{
            'Small':[10,5],
            'Large':[20,15]},
        'Pritt':{
            'Small':[12,8],
            'Large':[25,20]},
        'Camlin':{
            'Small':[8,5],
            'Large':[15,10]}},
           
    'Scissors':{'Small Scissors':{
            'Apsara':[30,10],
            'Nataraj':[40,15],
            'Maped':[50,30]},
        'Big Scissors':{
            'Faber-Castell':[80, 50],
            'Maped': [100,70],
            'Camlin': [120, 80]}},
           
    'Paper':{
        'A4 Paper':{
            'Classmate': [150, 100],
            'Prime': [200, 150],
            'Regal': [120, 90]},
        'Chart Paper': {
            'Apsara': [50, 20],
            'Classmate': [60, 40],
            'Maped': [70, 50]}},
           
    'Folder': {
        'File Folder': {
            'Camlin': [30, 15],
            'Apsara': [40, 25],
            'Nataraj': [50, 35]},
        'Document Folder': {
            'Classmate': [20, 10],
            'Prime': [30, 20],
            'Yuva': [40, 30]}},
           
    'Clipboard': {
        'Plastic Clipboard': {
            'Classmate': [25, 15],
            'Maped': [35, 25],
            'Apsara': [40, 30]},
        'Wooden Clipboard': {
            'Apsara': [60, 40],
            'Camlin': [70, 50],
            'Prime': [80, 60]}}}
def my_function():
    print("Wellcome! Wellcome! \n A to z Stationery")
    
def info():
    n =input("Enter your name.:")
    return n

def apply_discount(total_amount):
    """Applies discount based on the total amount spent."""
    discount = 0
    if total_amount >= 2000:
        discount = 0.15  # 15% discount for spending over ₹2000
    elif total_amount >= 1000:
        discount = 0.10  # 10% discount for spending over ₹1000
    return discount

def item_specific_discount(item_name, total):
    """Apply specific discounts for certain items like pens and books."""
    discount = 0
    if item_name == "Pen":
        discount = 0.05  # 5% discount on Pens
    elif item_name == "Book":
        discount = 0.07  # 7% discount on Books
    return total * discount
# Required imports
import pandas as pd
import matplotlib.pyplot as plt
import shutil

# Initialize total amount and shopping cart
total_amount = 0
cart = []

# Call functions to display welcome message and get customer name
my_function()
name = info()

# Start shopping loop
while True:
    print("\nAvailable Items:")
    for idx, item in enumerate(shoplist, start=1):
        print(f"{idx}. {item}")

    try:
        item_choice = int(input("\nEnter item number to buy (-1 to exit): "))
    except ValueError:
        print("Please enter a valid number.")
        continue

    if item_choice == -1:
        break

    if not (1 <= item_choice <= len(shoplist)):
        print("Invalid selection.")
        continue

    item_name = shoplist[item_choice - 1]

    if item_name not in Details:
        print("Item not available.")
        continue

    type_list = list(Details[item_name].keys())
    print(f"\nAvailable types for {item_name}:")
    for idx, t in enumerate(type_list, start=1):
        print(f"{idx}. {t}")

    try:
        type_choice = int(input("Enter type number: "))
        item_type = type_list[type_choice - 1]
    except (ValueError, IndexError):
        print("Invalid type choice.")
        continue

    subtype_list = list(Details[item_name][item_type].keys())
    print(f"\nAvailable subtypes for {item_type} {item_name}:")
    for idx, s in enumerate(subtype_list, start=1):
        print(f"{idx}. {s}")

    try:
        subtype_choice = int(input("Enter subtype number: "))
        item_subtype = subtype_list[subtype_choice - 1]
    except (ValueError, IndexError):
        print("Invalid subtype choice.")
        continue

    stock, price = Details[item_name][item_type][item_subtype]
    print(f"Price per unit: ₹{price}")

    try:
        quantity = int(input("Enter quantity: "))
        if quantity <= 0:
            raise ValueError
    except ValueError:
        print("Quantity must be a positive number.")
        continue

    if quantity > stock:
        print(f"Only {stock} available.")
        continue

    total = price * quantity
    item_discount = item_specific_discount(item_name, total)
    total -= item_discount
    total_amount += total

    cart.append({
        "name": item_name,
        "type": item_type,
        "subtype": item_subtype,
        "quantity": quantity,
        "price": price,
        "total": total
    })

    Details[item_name][item_type][item_subtype][0] -= quantity

    more = input("Do you want to order another item? (yes/no): ").strip().lower()
    if more != 'yes':
        break

# Generate the bill
if cart:
    print("\n" + "=" * 60)
    print(f"{'A to Z STATIONERY SHOP BILL':^60}")
    print("=" * 60)
    print(f"Customer Name: {name}")
    print("-" * 60)

    # Convert to DataFrame
    df = pd.DataFrame(cart)
    df = df.rename(columns={
        'quantity': 'Quantity',
        'subtype': 'Brand',
        'type': 'Type',
        'name': 'Item',
        'price': 'Unit Price (₹)',
        'total': 'Total (₹)'
    })[['Quantity', 'Brand', 'Type', 'Item', 'Unit Price (₹)', 'Total (₹)']]

    # Display table header
    print(f"{'Qty':<5} {'Brand':<15} {'Type':<20} {'Item':<10} {'Unit ₹':<10} {'Total ₹':<10}")
    print("-" * 60)

    # Display table rows
    for _, row in df.iterrows():
        print(f"{row['Quantity']:<5} {row['Brand']:<15} {row['Type']:<20} {row['Item']:<10} ₹{row['Unit Price (₹)']:<9.2f} ₹{row['Total (₹)']:<9.2f}")

    # Apply discount
    discount = apply_discount(total_amount)
    total_amount_after_discount = total_amount * (1 - discount)

    print("-" * 60)
    print(f"{'Total Amount':<50} ₹{total_amount:.2f}")
    print(f"{'Discount Applied':<50} {discount*100:.0f}%")
    print(f"{'Amount Payable After Discount':<50} ₹{total_amount_after_discount:.2f}")
    print("=" * 60)
    print(f"{'Thank you for shopping with us, ' + name + '!':^60}")
    print("=" * 60)

    # Charts
    plt.figure(figsize=(10, 5))
    df.groupby("Brand")["Quantity"].sum().plot(kind='bar', color='skyblue')
    plt.title("Quantity Purchased by Brand")
    plt.ylabel("Quantity")
    plt.xlabel("Brand")
    plt.xticks(rotation=45)
    plt.tight_layout()
    plt.grid(axis='y')
    plt.show()

    plt.figure(figsize=(8, 8))
    df.groupby("Item")["Total (₹)"].sum().plot(kind='pie', autopct='%1.1f%%', startangle=90)
    plt.title("Total Price Share by Item Category")
    plt.ylabel("")
    plt.tight_layout()
    plt.show()
else:
    print("No items were purchased.")
